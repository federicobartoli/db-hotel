GROUP BY



Conta gli ospiti raggruppandoli per anno di nascita

9. SELECT COUNT(`id`) AS 'query', YEAR(`date_of_birth`) FROM `ospiti`
GROUP BY YEAR(`date_of_birth`);


Somma i prezzi dei pagamenti raggruppandoli per status

10. SELECT SUM(`price`) AS 'sum', `status` FROM `pagamenti`
GROUP BY (`status`);


Conta quante volte è stata prenotata ogni stanza

11. SELECT COUNT(`stanza_id`) AS 'total_bookings', `stanza_id` FROM `prenotazioni`
GROUP BY (`stanza_id`);


Fai una analisi per vedere se ci sono ore in cui le prenotazioni sono più frequenti

12. SELECT COUNT(`id`) as 'hot_hours', HOUR(`created_at`) FROM `prenotazioni` GROUP BY HOUR(`created_at`) ORDER BY `hot_hours` DESC


Quante prenotazioni ha fatto l’ospite che ha fatto più prenotazioni?

13. SELECT COUNT(`id`) as 'number_of_bookings' , `ospite_id` FROM `prenotazioni_has_ospiti` GROUP BY `ospite_id` ORDER BY `number_of_bookings` DESC



Come si chiamano gli ospiti che hanno fatto più di due prenotazioni?

14.

SELECT ospiti.name, ospiti.lastname
FROM `prenotazioni_has_ospiti`
INNER JOIN `ospiti`
ON `prenotazioni_has_ospiti`.ospite_id = `ospiti`.id
GROUP BY `prenotazioni_has_ospiti`.ospite_id
HAVING COUNT(`prenotazioni_has_ospiti`.ospite_id) > 2
